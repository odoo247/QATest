<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Git Repository Form View -->
    <record id="view_qa_git_repository_form" model="ir.ui.view">
        <field name="name">qa.git.repository.form</field>
        <field name="model">qa.git.repository</field>
        <field name="arch" type="xml">
            <form string="Git Repository">
                <header>
                    <button name="test_connection" type="object" 
                            string="Test Connection" class="btn-primary"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Repository Name"/>
                        </h1>
                    </div>
                    <group>
                        <group string="Repository">
                            <field name="provider"/>
                            <field name="repo_url" placeholder="https://github.com/owner/repo"/>
                            <field name="branch"/>
                            <field name="module_path_pattern"/>
                        </group>
                        <group string="Authentication">
                            <field name="auth_type"/>
                            <field name="access_token" password="True"
                                   invisible="auth_type != 'token'"/>
                            <field name="username" invisible="auth_type != 'basic'"/>
                            <field name="password" password="True" 
                                   invisible="auth_type != 'basic'"/>
                        </group>
                    </group>
                    <group>
                        <group string="Advanced" invisible="provider != 'custom'">
                            <field name="api_url"/>
                        </group>
                        <group string="Status">
                            <field name="last_sync" readonly="1"/>
                            <field name="active"/>
                        </group>
                    </group>
                    <group invisible="not last_error">
                        <field name="last_error" readonly="1" class="text-danger"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- Git Repository Tree View -->
    <record id="view_qa_git_repository_tree" model="ir.ui.view">
        <field name="name">qa.git.repository.tree</field>
        <field name="model">qa.git.repository</field>
        <field name="arch" type="xml">
            <list string="Git Repositories">
                <field name="name"/>
                <field name="provider"/>
                <field name="repo_url"/>
                <field name="branch"/>
                <field name="auth_type"/>
                <field name="last_sync"/>
                <field name="active"/>
            </list>
        </field>
    </record>
    
    <!-- Git Repository Action -->
    <record id="action_qa_git_repository" model="ir.actions.act_window">
        <field name="name">Git Repositories</field>
        <field name="res_model">qa.git.repository</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Configure your first Git repository
            </p>
            <p>
                Connect to GitHub, GitLab, or Bitbucket to fetch source code 
                for enhanced test generation with business logic analysis.
            </p>
        </field>
    </record>
    
    <!-- Module Source Form View -->
    <record id="view_qa_module_source_form" model="ir.ui.view">
        <field name="name">qa.module.source.form</field>
        <field name="model">qa.module.source</field>
        <field name="arch" type="xml">
            <form string="Module Source">
                <header>
                    <button name="fetch_source" type="object" 
                            string="Fetch Source" class="btn-primary"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="module_id" options="{'no_create': True}"/>
                            <field name="repository_id"/>
                            <field name="branch" placeholder="Leave empty for default"/>
                        </group>
                        <group>
                            <field name="module_path" placeholder="Custom path override"/>
                            <field name="last_fetch" readonly="1"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    
    <!-- Module Source Tree View -->
    <record id="view_qa_module_source_tree" model="ir.ui.view">
        <field name="name">qa.module.source.tree</field>
        <field name="model">qa.module.source</field>
        <field name="arch" type="xml">
            <list string="Module Sources" editable="bottom">
                <field name="module_id"/>
                <field name="repository_id"/>
                <field name="branch"/>
                <field name="last_fetch"/>
            </list>
        </field>
    </record>
    
    <!-- Module Source Action -->
    <record id="action_qa_module_source" model="ir.actions.act_window">
        <field name="name">Module Sources</field>
        <field name="res_model">qa.module.source</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Link modules to their source code repositories
            </p>
            <p>
                Map installed Odoo modules to their source code location 
                in Git for enhanced code analysis.
            </p>
        </field>
    </record>
</odoo>
